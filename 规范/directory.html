<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="wap-font-scale" content="no" />
<meta name="renderer" content="webkit" />
<meta name="format-detection" content="telephone=no, email=no" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta name="format-detection" content="telephone=no, address=no, email=no" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="author" content="duminghong" />
<title></title>
<meta name="description" content="" />
<meta name="keywords" content="" />
<link rel="stylesheet" href="./css/markdown.css" />
<link rel="stylesheet" href="./css/monokai-sublime.min.css" />
</head>
<body>
	<article class="markdown-body">
		<h1 id="-">项目目录结构规范</h1>
<h2 id="-">简介</h2>
<p>该文档主要的设计目标是项目开发的目录结构保持一致，使容易理解并方便构建与管理。</p>
<h3 id="-">编撰</h3>
<p>李玉北、erik、黄后锦、王杨、张立理、赵雷、陈新乐、刘恺华。</p>
<p>本文档由<code>商业运营体系前端技术组</code>审校发布。</p>
<h3 id="-">要求</h3>
<p>在本文档中，使用的关键字会以中文+括号包含的关键字英文表示：必须(MUST)。关键字&quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot;被定义在rfc2119中。</p>
<h3 id="-">规范说明约定</h3>
<p>以下规范文档中：</p>
<ol>
<li><code>项目</code>包含但不限于<code>业务项目</code>和<code>包项目</code>。</li>
<li><code>${root}</code>表示<code>项目</code>的根目录。</li>
</ol>
<p><a name="restype"></a></p>
<h2 id="-">资源分类</h2>
<p><code>资源</code>分成两大类：</p>
<ol>
<li><code>源代码资源</code>：指开发者编写的源代码，包括<code>js</code>、<code>html</code>、<code>css</code>、<code>template</code>等。</li>
<li><code>内容资源</code>：指希望做为内容提供给访问者的资源，包括<code>图片</code>、<code>字体</code>、<code>flash</code>、<code>pdf</code>等。</li>
</ol>
<h2 id="-">目录命名原则</h2>
<ol>
<li>简洁。有习惯性缩写的单词 <em>必须(MUST)</em> 采用容易理解的缩写。如：源代码目录使用<code>src</code>，不使用<code>source</code>。下面是更多例子：<ol>
<li><code>img</code>: 图片。 <em>不允许(MUST NOT)</em> 使用<code>image</code>、<code>images</code>、<code>imgs</code>等。</li>
<li><code>js</code>: javascript脚本。 <em>不允许(MUST NOT)</em> 使用<code>script</code>、<code>scripts</code>等。</li>
<li><code>css</code>: 样式表。 <em>不允许(MUST NOT)</em> 使用<code>style</code>、<code>styles</code>等。</li>
<li><code>swf</code>: flash。 <em>不允许(MUST NOT)</em> 使用<code>flash</code>等。</li>
<li><code>src</code>: 源文件目录。 <em>不允许(MUST NOT)</em> 使用<code>source</code>等。</li>
<li><code>dep</code>: 引入的第三方依赖包目录。 <em>不允许(MUST NOT)</em> 使用<code>lib</code>、<code>library</code>、<code>dependency</code>等。</li>
</ol>
</li>
<li><em>不允许(MUST NOT)</em> 使用复数形式。如：<code>imgs</code>、<code>docs</code>是不被允许的。</li>
</ol>
<h2 id="-">目录划分</h2>
<p><a name="root"></a></p>
<h3 id="-root-">${root}目录结构划分</h3>
<p>在${root}下，目录结构 <em>必须(MUST)</em> 按照<code>职能</code>进行划分， <em>不允许(MUST NOT)</em> 将<code>资源类型</code>或<code>业务逻辑</code>划分的目录直接置于${root}下。</p>
<p>常用的目录有<code>src</code>、<code>doc</code>、<code>dep</code>、<code>test</code>等。详细请参考<a href="#level1">一级目录详细说明</a></p>
<pre><code>${root}/
    src/
    test/
    doc/
    dep/
    ...
</code></pre><h3 id="-">业务项目目录结构划分</h3>
<p><code>业务项目</code>的${root}目录结构划分遵循<a href="#root">${root}目录结构划分</a>。</p>
<h4 id="-">项目代号</h4>
<p>业务项目 <em>可以(SHOULD)</em> 为项目起一个代号名称。代号名称 <em>必须(MUST)</em> 为一个单词，不宜过长。例：北斗的项目代号为<code>triones</code>，哥伦布的项目代号为<code>clb</code>，百度锦囊的项目代号为<code>jn</code>。项目代号有利于区分不同项目，为未来项目之间的重用留下扩展的后路。</p>
<p>在项目开发时，通常会使用如下<a href="module.md#config">加载器配置</a>，将项目代号指向<code>src</code>。</p>
<pre><code class="lang-javascript">{
    baseUrl: &#39;${docroot}&#39;,
    paths: {
        &#39;triones&#39;: &#39;src&#39;
    }
}
</code></pre>
<h4 id="-src-">根据业务逻辑划分src目录结构</h4>
<p><code>业务项目</code>的<code>src</code>目录内，绝大多数情况 <em>应当(SHOULD)</em> 根据<code>业务逻辑</code>划分目录结构。划分出的子目录（比如<a href="#bizdirexample">例子</a>中的<code>biz1</code>）我们称为<code>业务目录</code>。</p>
<p><code>src</code>下 <em>必须(MUST)</em> 只包含<code>业务目录</code>与<code>common</code>目录。<code>业务公共资源</code> <em>必须(MUST)</em> 命名为<code>common</code>。<code>common</code>目录做为<code>业务公共资源</code>的目录，也视如<code>业务目录</code>。</p>
<pre><code>${root}/
    src/
        common/
        biz1/
            subbiz1/
            subbiz2/
        biz2/
</code></pre><p>较小规模的<code>业务项目</code>（如投放端），<code>src</code>目录允许视如<code>业务目录</code>，直接按照<a href="#bizdirprinciple">业务目录划分原则</a>划分目录结构。</p>
<pre><code>${root}/
    src/
        foo.js
</code></pre><p><a name="bizdirprinciple"></a></p>
<h4 id="-">业务目录划分原则</h4>
<ol>
<li><code>JS资源</code> <em>不允许(MUST NOT)</em> 按<code>资源类型</code>划分目录， <em>必须(MUST)</em> 按<code>业务逻辑</code>划分目录。<code>JS资源</code>应直接置于<code>业务目录</code>下。即：<code>业务目录</code>下不允许出现<code>js</code>目录。</li>
<li>除<code>JS资源</code>外的<code>源文件资源</code>，当资源数量较多时，为方便管理， <em>允许(SHOULD)</em> 按<code>资源类型</code>划分目录。即：<code>业务目录</code>下允许出现<code>css</code>、<code>tpl</code>目录。</li>
<li><code>内容资源</code> <em>允许(SHOULD)</em> 按<code>资源类型</code>划分目录。即：<code>业务目录</code>下允许出现<code>img</code>、<code>swf</code>、<code>font</code>目录。</li>
<li><code>业务目录</code>中，如果文件太多不好管理，需要划分子目录时，也 <em>必须(MUST)</em> 继续遵守根据<code>业务逻辑</code>划分的原则，划分子业务。如：下面例子中的<code>subbiz1</code>。</li>
</ol>
<p>通常，对于一个<code>业务目录</code>， <em>鼓励(SHOULD)</em> 将业务相关的<code>源文件资源</code>都直接置于<code>业务目录</code>下。</p>
<pre><code>biz1/
    img/
        add_button.png
    add.js
    add.tpl.html
    add.css
</code></pre><p><code>业务目录</code>下<code>源文件资源</code>数量较多时，我们第一直觉应该是：是否业务划分不够细？是否应该划分子业务，建立子业务目录？</p>
<pre><code>biz2/
    subbiz1/
        list.js
        list.tpl.html
        list.css
    subbiz2/
</code></pre><p>遇到确实是一个业务整体，无法划分子业务时， <em>允许(MAY)</em> 将非<code>JS资源</code>按<code>资源类型</code>划分目录进行管理。</p>
<pre><code>biz1/
    css/
        add.css
        edit.css
        remove.css
        img/
            add_button.png
    tpl/
        add.html
        edit.html
        remove.html
    add.js
    edit.js
    remove.js
</code></pre><p><code>源文件资源</code>和<code>内容资源</code>请参考<a href="#restype">资源分类</a>章节，常用<code>资源目录</code>请参考<a href="#resdir">资源目录</a>章节，常用<code>业务目录</code>请参考<a href="#bizdir">业务目录</a>章节。</p>
<p><a name="bizdirexample"></a></p>
<h4 id="-">业务项目目录划分示例</h4>
<pre><code>${root}/
    src/
        common/
            img/
                sprites.png
                logo.png
            conf.js
            layout.css
        biz1/
            img/
                add_button.png
            add.js
            add.tpl.html
            add.less
        biz2/
            subbiz1/
                list.js
                list.tpl.html
                list.css
            subbiz2/
    dep/
        er/
            src/
            test/
        esui/
            src/
            test/
    test/
    doc/
    index.html
    main.html
    ......
</code></pre><p><a name="packagedir"></a></p>
<h3 id="-">包项目目录结构划分</h3>
<p><code>包项目</code>的${root}目录结构划分遵循<a href="#root">${root}目录结构划分</a>。</p>
<p><a name="packagesrc"></a></p>
<h4 id="-src-">包项目src目录结构划分</h4>
<p><code>包</code>是实现某个独立功能，有复用价值的代码集。按照通常的理解，一个<code>包项目</code>不应该特别复杂。</p>
<p>所以，<code>包</code>可视如一个不太复杂的<code>业务</code>，其<code>src</code>下的划分原则与<code>业务项目</code>的<a href="#bizdirprinciple">业务目录划分原则</a>保持一致。</p>
<pre><code>${root}/
    src/
        css/
            img/
                sprites.png
            table.css
            button.css
            select.css
        main.js
        Control.js
        InputControl.js
        Button.js
        Table.js
        Select.js
    test/
    doc/
    package.json
    ...
</code></pre><h2 id="-">常用目录</h2>
<p><a name="level1"></a></p>
<h3 id="-">一级目录</h3>
<p>直接置于<code>${root}</code>下的目录称作<code>一级目录</code>。一级目录 <em>必须(MUST)</em> 具有某种<code>职能</code>属性。</p>
<p>除了下面列举的一些常见目录之外，<code>${root}</code>下面也可以放置一些跟项目发布相关的文件，例如<code>build.sh</code>，<code>build.xml</code>，<code>Makefile</code>，<code>Gruntfile</code>等等.</p>
<h4 id="src">src</h4>
<p><code>src</code>目录用于存放开发时源文件，发布时 <em>必须(MUST)</em> 被删除。</p>
<h4 id="dep">dep</h4>
<p><code>dep</code>目录用于存放<code>项目</code>引入依赖的第三方包。该目录下的内容通过平台工具管理，项目开发人员 <em>不允许(MUST NOT)</em> 更改<code>dep</code>目录下第三方包的任何内容。</p>
<p>当项目需要修改引入的第三方代码时，第三方包应将源码直接置于<code>${root}/src</code>目录下，规则见该目录下的规定。</p>
<p>更多关于<code>包</code>的内容请参考 <a href="package.md">包结构规范</a></p>
<h4 id="tool">tool</h4>
<p><code>tool</code>目录用于存放开发时或构建阶段使用的工具。该目录在发布时 <em>必须(MUST)</em> 被删除。</p>
<h4 id="test">test</h4>
<p><code>test</code>目录用于存放测试用例以及开发阶段的模拟数据。该目录在发布时 <em>必须(MUST)</em> 被删除。</p>
<h4 id="doc">doc</h4>
<p><code>doc</code>目录用于存放项目文档。项目文档可能是开发者维护的文档，也可能是通过工具生成的文档。</p>
<h4 id="entry">entry</h4>
<p><code>entry</code>目录用于存放项目的<code>页面入口文件</code>，通常是上线后可被直接访问的静态页面。</p>
<p><code>RIA项目</code>通常会包含较少的<code>页面入口文件</code>，常见的是<code>main.html</code>，这些文件 <em>可以(SHOULD)</em> 直接放在<code>${root}</code>目录下。</p>
<pre><code>${root}/
    src/
        common/
            conf.js
        card/
        gold/
        message/
    index.html
    main.html
    ......
</code></pre><p><code>多页面项目</code>通常<code>页面入口文件</code>较多， <em>可以(SHOULD)</em> 统一放在<code>entry</code>目录中，按<code>业务逻辑</code>命名。</p>
<pre><code>${root}/
    src/
        common/
            conf.js
        card/
        gold/
        message/
    entry/
        card.html
        gold.html
        message.html
        ......
</code></pre><p>项目在发布的时候，构建工具可以<code>页面入口文件</code>为入口进行分析和编译。</p>
<p><code>RIA项目</code>经过构建工具编译后，目录结构可能如下：</p>
<pre><code>output/
    asset/
        js/
        css/
        tpl/
        img/
    index.html
    main.html
</code></pre><p><code>多页面项目</code>经过构建工具编译后，目录结构可能如下：</p>
<pre><code>output/
    card/
        asset/
            js/
            css/
            img/
        index.html
    gold/
        asset/
            js/
            css/
            img/
        index.html
</code></pre><h4 id="asset">asset</h4>
<p><code>asset</code>目录用于存放用于<code>线上访问</code>的静态资源。</p>
<p>通常构建工具会对<code>src</code>目录和<code>dep</code>目录下的资源进行分析、合并与压缩等，生成到<code>asset</code>目录下。所以该目录尽量避免手工管理。下面是一个构建工具生成后的<code>asset</code>目录示例：</p>
<pre><code>${root}/
    asset/
        js/
            loader.js
            build.js
        css/
            common.css
            img/
        tpl/
            build.tpl.html
        img/
        ...
</code></pre><p><a name="resdir"></a></p>
<h3 id="-">资源目录</h3>
<p>按<code>资源</code>类型命名的目录称作<code>资源目录</code>。<code>资源目录</code> <em>不允许(MUST NOT)</em> 直接置于${root}下。</p>
<h4 id="js">js</h4>
<p><code>js</code>目录可用于存放<code>js</code>资源文件（包含可编译成<code>js</code>的<code>coffeescript</code>等语言）。<code>js</code>文件后缀名 <em>必须(MUST)</em> 为.js，<code>coffeescript文件</code>后缀名 <em>必须(MUST)</em> 为.coffee。</p>
<p><code>js</code>目录内 <em>必须(MUST)</em> 存放<code>js</code>资源文件，但<code>js</code>资源文件不一定（MAY NOT）存放于<code>js</code>目录下：</p>
<ol>
<li>对于<code>src</code>目录，<code>js</code>资源文件 <em>不允许(MUST NOT)</em> 存放于<code>js</code>目录下。</li>
<li>对于<code>asset</code>目录，<code>js</code>资源文件 <em>可以(SHOULD)</em> 存放于<code>js</code>目录下，视构建行为决定。</li>
<li>对于其他<code>一级目录</code>内，<code>js</code>资源文件 <em>可以(SHOULD)</em> 不存放于<code>js</code>目录下。</li>
</ol>
<h4 id="css">css</h4>
<p><code>css</code>目录可用于存放<code>css资源文件</code>（包含<code>less</code>，<code>sass</code>等动态样式表语言）。<code>css</code>文件后缀名 <em>必须(MUST)</em> 为.css，<code>less</code>文件后缀名 <em>必须(MUST)</em> 为<code>.less</code>。</p>
<p><code>css</code>目录内 <em>必须(MUST)</em> 存放<code>css</code>资源文件，但<code>css</code>资源文件不一定（MAY NOT）存放于<code>css</code>目录下：</p>
<ol>
<li>对于<code>src</code>目录，<code>css</code>资源文件 <em>可以(SHOULD)</em> 存放于<code>业务目录</code>下，也 <em>可以(SHOULD)</em> 存放于<code>css</code>目录下。</li>
<li>对于<code>asset</code>目录，<code>css</code>资源文件 <em>可以(SHOULD)</em> 存放于<code>css</code>目录下，视构建行为决定。</li>
<li>对于其他<code>一级目录</code>内，<code>css</code>资源文件 <em>可以(SHOULD)</em> 不存放于<code>css</code>目录下。</li>
</ol>
<p>关于css引用图片的位置说明，请参考<a href="#imgdir">img</a>章节。</p>
<p><a name="imgdir"></a></p>
<h4 id="img">img</h4>
<p><code>img</code>目录可用于存放<code>图片资源文件</code>。包括<code>页面直接引用</code>的图片与<code>css引用</code>图片。常见的图片资源有<code>gif/jpg/png/svg/bmp</code>等。</p>
<p>对于<code>css</code>引用的图片， <em>必须(MUST)</em> 放在<code>./img</code>目录下，<code>.</code>代表当前<code>css</code>资源所在的目录。</p>
<p>对于<code>页面直接引用</code>的图片：</p>
<ol>
<li>被多页面引用的图片 <em>应该(SHOULD)</em> 放在<code>${root}/src/common/img</code>目录下。</li>
<li>单一页面引用的图片 <em>应该(SHOULD)</em> 放在<code>./img</code>目录下，<code>.</code>代表当前页面所在的目录。</li>
</ol>
<h4 id="tpl">tpl</h4>
<p><code>tpl</code>目录可用于存放<code>template</code>资源文件。<code>template</code>资源文件后缀名 <em>可以(SHOULD)</em> 为<code>.html</code>或<code>.tpl</code>。</p>
<p>通常，对于<code>RIA</code>系统，<code>template</code>资源文件采用<code>.html</code>后缀使其能够被<code>xhr</code>加载。</p>
<h4 id="font">font</h4>
<p><code>font</code>目录可用于存放字体资源文件。常见的字体资源有<code>tff/woff/svg</code>等。</p>
<h4 id="swf">swf</h4>
<p><code>swf</code>目录可用于存放<code>flash</code>资源文件。<code>flash</code>资源文件 <em>不允许(MUST NOT)</em> 置于<code>img</code>目录中。</p>
<p><a name="bizdir"></a></p>
<h3 id="-">业务目录</h3>
<p><a name="commondir"></a></p>
<h4 id="common">common</h4>
<p><code>common</code>目录为业务公共目录，用于存放业务项目的业务公共文件。所以，根据<code>业务逻辑</code>划分目录结构时，业务逻辑命名 <em>不允许(MUST NOT)</em> 为<code>common</code>。</p>
<h2 id="faq">FAQ</h2>
<h3 id="-biz-">为啥biz下面没资源类型目录了？</h3>
<p>如果在<code>biz</code>下继续划分<code>资源目录</code>，代码的结构可能就是这样子了：</p>
<pre><code>${root}/
    src/
        biz1/
            js/
                list.js
</code></pre><p>当我们需要使用<code>list.js</code>的时候，必须写如下的代码：<code>require(&quot;../biz1/js/list&quot;)</code>，但是从逻辑上说，更合理的写法应该是<code>require(&quot;../biz1/list&quot;)</code>。因此我们不推荐在<code>biz</code>下面对源代码资源划分目录。</p>

	</article>
<script type="text/javascript" src="./js/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="./js/highlight.min.js"></script>
<script type="text/javascript">
	$(function(){
		// $("pre").addClass("prettyprint");

	    // 添加行号
	    $('pre code').each(function(){
	        var lines = $(this).text().split('\n').length - 1;
	        var $numbering = $('<ul/>').addClass('pre-numbering');
	        $(this).addClass('has-numbering').parent().append($numbering);
	        for(var i=1;i<=lines;i++){
	            $numbering.append($('<li/>').text(i));
	        }
	    });

	    // 高亮
	    hljs.initHighlighting();
	});
</script>
</body>
</html>